[uwsgi]
# 基础配置
socket = 127.0.0.1:9001  # 必须与nginx upstream端口一致
chdir = /data/parking_system
wsgi-file = parking_system/wsgi.py
virtualenv = /envs/five_class_demo

# 进程优化
processes = 3
threads = 2
enable-threads = true
master = true  # 新增master进程管理

# 稳定性增强
die-on-term = true
need-app = true
vacuum = true
max-requests = 500
harakiri = 60  # 进程超时时间(秒)
reload-mercy = 10  # 优雅重启等待时间

# 性能监控
stats = /tmp/uwsgi_stats.sock
memory-report = true

# 日志配置
logto = /var/log/uwsgi/parking.log
log-encoder = format:${strftime:%%Y-%%m-%%d %%H:%%M:%%S} [pid: %(pid)] %(msg)